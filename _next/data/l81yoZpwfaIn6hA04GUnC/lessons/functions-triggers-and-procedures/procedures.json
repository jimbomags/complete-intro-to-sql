{"pageProps":{"post":{"attributes":{"description":""},"html":"<p>A different-but-similar idea to functions is procedures. They&#39;re really similar and have a lot of overlap but have some slight differences.</p>\n<p>Functions can do more. Almost everything that procedures can do functions can also do whereas vice versa is not true.</p>\n<p>A procedure is designed to do an action of some variety. It&#39;s explictly <em>not</em> for returning data (and cannot return data) whereas a function can return data (but does not have to.)</p>\n<p>Let&#39;s make an example with our recipes database. Let&#39;s say we have some churn on our ingredients where images can get created and deleted and sometimes images are set to null. Let&#39;s say we wanted to <em>tolerate</em> that (as in we don&#39;t want to make it so there&#39;s a constraint on the image column on NOT NULL) but we periodically want to go update that column to be default.jpg if there&#39;s nothing set. First, let&#39;s select everything has null for an image.</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT</span> <span class=\"hljs-operator\">*</span> <span class=\"hljs-keyword\">FROM</span> ingredients <span class=\"hljs-keyword\">WHERE</span> image <span class=\"hljs-keyword\">IS</span> <span class=\"hljs-keyword\">NULL</span>;\n</code></pre>\n<p>Nothing right now (if you&#39;ve been following along with me.) So let&#39;s insert another real quick.</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">INSERT</span> <span class=\"hljs-keyword\">INTO</span>\n  ingredients\n  (title, type)\n<span class=\"hljs-keyword\">VALUES</span>\n  (<span class=\"hljs-string\">&#x27;venison&#x27;</span>, <span class=\"hljs-string\">&#x27;meat&#x27;</span>);\n</code></pre>\n<p>Okay, let&#39;s try our query again.</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT</span> <span class=\"hljs-operator\">*</span> <span class=\"hljs-keyword\">FROM</span> ingredients <span class=\"hljs-keyword\">WHERE</span> image <span class=\"hljs-keyword\">IS</span> <span class=\"hljs-keyword\">NULL</span>;\n</code></pre>\n<p>We could write an update that we run via cron job that just called <code>UPDATE</code> but let&#39;s write a procedure that does it.</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">PROCEDURE</span>\n  set_null_ingredient_images_to_default()\n<span class=\"hljs-keyword\">LANGUAGE</span>\n  <span class=\"hljs-keyword\">SQL</span>\n<span class=\"hljs-keyword\">AS</span>\n$$\n  <span class=\"hljs-keyword\">UPDATE</span>\n    ingredients\n  <span class=\"hljs-keyword\">SET</span>\n    image <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&#x27;default.jpg&#x27;</span>\n  <span class=\"hljs-keyword\">WHERE</span>\n    image <span class=\"hljs-keyword\">IS</span> <span class=\"hljs-keyword\">NULL</span>;\n$$;\n</code></pre>\n<ul>\n<li>Notice we did not use the <code>plpgsql</code> language but the <code>SQL</code> language. Because this is a simple query without any other bells or whistles, we can use straight SQL as the language. If we needed conditionals, loops, or any other programming &quot;stuff&quot; we&#39;d need something like plpgsql, JavaScript, Python, etc.</li>\n<li>Other than that, this looks a lot like a function with no return type. It does its action and it is done.</li>\n</ul>\n<p>Okay, let&#39;s invoke this procedure now.</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">CALL</span> set_null_ingredient_images_to_default();\n<span class=\"hljs-keyword\">SELECT</span> <span class=\"hljs-operator\">*</span> <span class=\"hljs-keyword\">FROM</span> ingredients <span class=\"hljs-keyword\">WHERE</span> image <span class=\"hljs-keyword\">IS</span> <span class=\"hljs-keyword\">NULL</span>;\n</code></pre>\n<p>You use <code>CALL</code> instead of SELECT to invoke procedures. Now we can invoke this procedure whenever we need to periodically make some maintenance to our images.</p>\n<p>We&#39;ll expand on a great way to use procedures in the next lesson with triggers.</p>\n","slug":"procedures","title":"Procedures","section":"Functions Triggers and Procedures","icon":"stairs","filePath":"/home/runner/work/complete-intro-to-sql/complete-intro-to-sql/lessons/07-functions-triggers-and-procedures/B-procedures.md","nextSlug":"/lessons/functions-triggers-and-procedures/triggers","prevSlug":"/lessons/functions-triggers-and-procedures/functions"}},"__N_SSG":true}