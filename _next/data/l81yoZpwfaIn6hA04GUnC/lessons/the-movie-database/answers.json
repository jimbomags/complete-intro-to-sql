{"pageProps":{"post":{"attributes":{},"html":"<h2 id=\"which-movie-made-the-most-money\">Which movie made the most money?</h2>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT</span>\n  name, revenue\n<span class=\"hljs-keyword\">FROM</span>\n  movies\n<span class=\"hljs-keyword\">ORDER</span> <span class=\"hljs-keyword\">BY</span>\n  <span class=\"hljs-built_in\">COALESCE</span>(revenue, <span class=\"hljs-number\">0</span>) <span class=\"hljs-keyword\">DESC</span>\nLIMIT <span class=\"hljs-number\">5</span>;\n</code></pre>\n<h2 id=\"how-much-revenue-did-the-movies-keanu-reeves-act-in-make\">How much revenue did the movies Keanu Reeves act in make?</h2>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT</span>\n  <span class=\"hljs-built_in\">COALESCE</span>(<span class=\"hljs-built_in\">SUM</span>(m.revenue),<span class=\"hljs-number\">0</span>) <span class=\"hljs-keyword\">AS</span> total\n<span class=\"hljs-keyword\">FROM</span>\n  movies m\n\n<span class=\"hljs-keyword\">INNER</span> <span class=\"hljs-keyword\">JOIN</span>\n  casts c\n<span class=\"hljs-keyword\">ON</span>\n  m.id <span class=\"hljs-operator\">=</span> c.movie_id\n\n<span class=\"hljs-keyword\">INNER</span> <span class=\"hljs-keyword\">JOIN</span>\n  people p\n<span class=\"hljs-keyword\">ON</span>\n  c.person_id <span class=\"hljs-operator\">=</span> p.id\n\n<span class=\"hljs-keyword\">WHERE</span>\n  p.name <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&#x27;Keanu Reeves&#x27;</span>;\n</code></pre>\n<h2 id=\"which-5-people-were-in-the-movies-that-had-the-most-revenue\">Which 5 people were in the movies that had the most revenue?</h2>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT</span>\n  p.name, <span class=\"hljs-built_in\">COALESCE</span>(<span class=\"hljs-built_in\">SUM</span>(m.revenue),<span class=\"hljs-number\">0</span>) <span class=\"hljs-keyword\">AS</span> total\n<span class=\"hljs-keyword\">FROM</span>\n  movies m\n\n<span class=\"hljs-keyword\">INNER</span> <span class=\"hljs-keyword\">JOIN</span>\n  casts c\n<span class=\"hljs-keyword\">ON</span>\n  m.id <span class=\"hljs-operator\">=</span> c.movie_id\n\n<span class=\"hljs-keyword\">INNER</span> <span class=\"hljs-keyword\">JOIN</span>\n  people p\n<span class=\"hljs-keyword\">ON</span>\n  c.person_id <span class=\"hljs-operator\">=</span> p.id\n\n<span class=\"hljs-keyword\">GROUP</span> <span class=\"hljs-keyword\">BY</span>\n  p.id, p.name\n\n<span class=\"hljs-keyword\">ORDER</span> <span class=\"hljs-keyword\">BY</span>\n  total <span class=\"hljs-keyword\">DESC</span>\n\nLIMIT <span class=\"hljs-number\">5</span>;\n</code></pre>\n<h2 id=\"which-10-movies-have-the-most-keywords\">Which 10 movies have the most keywords?</h2>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT</span>\n  m.name, <span class=\"hljs-built_in\">COUNT</span>(c.id) <span class=\"hljs-keyword\">AS</span> count\n<span class=\"hljs-keyword\">FROM</span>\n  movies m\n\n<span class=\"hljs-keyword\">INNER</span> <span class=\"hljs-keyword\">JOIN</span>\n  movie_keywords mk\n<span class=\"hljs-keyword\">ON</span>\n  mk.movie_id <span class=\"hljs-operator\">=</span> m.id\n\n<span class=\"hljs-keyword\">INNER</span> <span class=\"hljs-keyword\">JOIN</span>\n  categories c\n<span class=\"hljs-keyword\">ON</span>\n  mk.category_id <span class=\"hljs-operator\">=</span> c.id\n\n<span class=\"hljs-keyword\">GROUP</span> <span class=\"hljs-keyword\">BY</span>\n  m.id, m.name\n\n<span class=\"hljs-keyword\">ORDER</span> <span class=\"hljs-keyword\">BY</span>\n  count <span class=\"hljs-keyword\">DESC</span>\n\nLIMIT <span class=\"hljs-number\">10</span>;\n</code></pre>\n<h2 id=\"which-category-is-associated-with-the-most-movies\">Which category is associated with the most movies</h2>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT</span>\n  c.name, <span class=\"hljs-built_in\">COUNT</span>(mk.category_id) <span class=\"hljs-keyword\">AS</span> count\n<span class=\"hljs-keyword\">FROM</span>\n  movie_keywords mk\n\n<span class=\"hljs-keyword\">INNER</span> <span class=\"hljs-keyword\">JOIN</span>\n  categories c\n<span class=\"hljs-keyword\">ON</span>\n  c.id <span class=\"hljs-operator\">=</span> mk.category_id\n\n<span class=\"hljs-keyword\">GROUP</span> <span class=\"hljs-keyword\">BY</span>\n  c.name, mk.category_id\n\n<span class=\"hljs-keyword\">ORDER</span> <span class=\"hljs-keyword\">BY</span>\n  count <span class=\"hljs-keyword\">DESC</span>\n\nLIMIT <span class=\"hljs-number\">5</span>;\n</code></pre>\n","slug":"answers","title":"Answers","section":"The Movie Database","icon":"clapperboard","filePath":"/home/runner/work/complete-intro-to-sql/complete-intro-to-sql/lessons/08-the-movie-database/B-answers.md","nextSlug":"/lessons/the-movie-database/pgadmin","prevSlug":"/lessons/the-movie-database/exercises"}},"__N_SSG":true}